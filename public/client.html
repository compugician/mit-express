<style>
html, body {
  overflow: hidden;
}
</style>
<script src="http://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.21/p5.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.7/socket.io.min.js"></script>

<script type="text/javascript">
'use strict';

// socket io
var socket = io.connect('http://localhost:3000/');

var dotDiameter, r, g, b, flow, colorIdx;

// canvas script
function setup() {
  createCanvas(window.innerWidth, window.innerHeight);
  noStroke();
  dotDiameter = Math.random() * 15 + 10;
  // TODO correlate this to the colorIdx
  r = Math.random() * 156 + 100;
  g = Math.random() * 156 + 100;
  b = Math.random() * 156 + 100;
  flow = 0;
  colorIdx = 0;
}

function draw() {
  socket.emit('point', {
    x: mouseX,
    y: mouseY,
    dotDiameter: dotDiameter,
    color: {
      r: r,
      g: g,
      b: b,
      a: 2.55*flow
    },
    colorIdx: colorIdx,
    flow: flow
  });
}

function mousePressed() {
  r = Math.random() * 156 + 100;
  g = Math.random() * 156 + 100;
  b = Math.random() * 156 + 100;
}

function keyPressed() {
	switch(keyCode){
		case (UP_ARROW):
			flow += 10
			if (flow > 100){
				flow = 100;
			}
			break;
		case (DOWN_ARROW):
			flow = (flow - 10) ? flow > 10 : 0;
			break;
		case (RIGHT_ARROW):
			dotDiameter += 5;
			break;
		case (LEFT_ARROW):
			dotDiameter -= 5;
			break;
	}
	
  if (parseInt(key) || key === '0') {
    colorIdx = parseInt(key) * 2;
  }
}
</script>